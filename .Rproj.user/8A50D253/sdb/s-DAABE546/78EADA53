{
    "contents" : "#### SETUP ####\nrm(list=ls(all=TRUE)) #Clear out variables from previous runs.\noptions(\"scipen\"=10, \"digits\"=3) # control the decimal places in the output\n\n# Install packages if necessary\n# install.packages(\"psych\")  \n# install.packages(\"corrgram\") \n\n## load the packages\nlibrary(psych) # multipurpose for psychologist\nlibrary(corrgram) # for graphing correlation matrices\nlibrary(Hmisc)# multipurpose\nlibrary(sem) # structural equation modeling\nlibrary(reshape2) # data transformation\nlibrary(ggplot2) # general graphing\nlibrary(plotrix) # ploting matrix graphs\n\n# Please consult the website of James Steiger (www.statpower.net) for all materials pertaining to this demonstration. ( See Psychology 312)\n\n## load some custom functions\n# Useful function for multivariate stats\nsource(\"http://statpower.net/Content/312/R%20Stuff/Steiger%20R%20Library%20Functions.txt\")\n# Functions to assist you in FA and SEM\nsource(\"http://statpower.net/Content/312/R%20Stuff/AdvancedFactorFunctions.txt\")\n# Functions by Dirk Enzmann to aid promax rotation\nsource(\"http://statpower.net/Content/312/R%20Stuff/fa.promax.R\")\n\n\npathHome <- getwd()\npathFile <- file.path(pathHome,\"Homework/HW3.txt\")\npathVarnames <- file.path(pathHome,\"Homework/varnames.txt\")\n\n#### Data prep ####\n\nds <- read.table(pathFile, as.is=T) # read in the data\nhead(ds) # print the first few lines\nstr(ds) # examine the structure of the object\ndim(ds)\nnrow(ds)\n\n# convert \".\" into missing values \nds[ds == \".\"] <- NA\nds[ds == \"No\"] <- 0\nds[ds == \"Yes\"] <- 1\n\n\nView(ds)\n# # convert into factors and assign labels\n# noyesLevels<- c(0,1) # what numeric values should represent levels\n# noyesLabels<- c(\"NO\", \"YES\") # what character strings should represent levels\n# # loop through all  variable names\n# for(i in  colnames(ds)){\n#   ds[,i]<- factor(ds[,i], levels = noyesLevels,labels = noyesLabels)\n# }\n\nfor(i in  colnames(ds)){\n  ds[,i]<- as.numeric(ds[,i])\n}\n\n# subset the data to keep only the row without any missing values\nds <- na.omit(ds)\n  \n\n# passing descriptive names to the variables\n#varNames <- paste(\"var\",1:19)\nvarNames <- c(“activity”,”anxious”,”quick”,”noreason”,”backgrnd”,”cheerful”,”late”,”tired”,”lively”,”quickly”,\n                ”thoughts”,”reserved”,”sensitiv”,”restless”,”nosleep”,”keepself”,”nervous”,”joke”,”worry\") \n\n\n#### Examine correlations ####\n\n# compute correlation matrix\nR <- cor(ds)\n\n# Print the corrleation matrix \nR\n# print a correlogram of the correlation matrix using corrgram() function of the corrgram package, use default options\ncorrgram(R)\n# customize the correlogram so that the lower triangle gives pie graphs and upper triangle shows the numerical values for the correlation\ncorrgram(R,upper.panel=panel.conf,lower.panel=panel.pie) \n# further customize the correlogram so that variable are ordered according to the PCA logic\ncorrgram(R,upper.panel=panel.conf,lower.panel=panel.pie, order = T) \n\n\n#### Question 1 ####\n# How many clusters does a visual inspection of the correlogram suggest?\n# A: looks like two\n\n#### Conduct factor analysis ####\n\n# list the numerical values of the eignevalues to be examined directly\neigen(R)$values\n# Use Scree.Plot() function to request the graph of eigenvalues, add a descriptive title\nScree.Plot(R, main=\"Scree plot of 19 Psychological variables (n=360)\") # plot the eigen values\n\n#### Question 2 ####\n# How many factors does the scree plot suggest to extract? Explain your reasoning \n# A: 3, 4, or 5, depending on the rules you adopt in decision making\n\n# Use FA.Stats() function to request Chi-Square and RMSEA statistics, add a descriptive title\nFA.Stats(R, n.factors=1:10, n.obs=360, main=\"RMSEA plot of 19 Psych Variables (n=360)\") # Request Chi-Square and RMSEA stats\n\n#### Question 3 ####\n# How many factors does the Chi-Square criteria suggest to extract? Explain your reasoning \n# A: 4, with 4 factors we can fail to reject the hypothesis of perfect fit at apha=.05\n\n#### Question 4 ####\n# How many factors does the RMSEA criteria suggest to extract? Explain your reasoning \n# A: 4, with 4 factors the confidence interval for the point estimate includes zero\n\nout <- MLFA(Correlation.Matrix = R, n.factors=4, n.obs=360) # conduct MLFA and collect all rotations in a single object\nLoadings(out, cutoff=.3, num.digits=2) \n\n#### Note on RMSEA ####\n#### NOTE : The RMSEA index can be thought of roughly as a root mean square standardized residual. \n#### values above .10 indicate an inadequate fit, \n#### values below .05 indicate a very good fit.\n#### Point estimates below .01 indicate an outstanding fit, and are seldom obtained.\n#### CONFIDENCE INTERVALS must be interpreted, not the point estimates!!!\n#### Look for the point estimate whose confidence interval includes zero \n####    (indicating a failure to reject the null hypothesis of perfect fit, i.e., RMSEA = 0, at the 0.05 level).\n\n\n#### Note on MLFA ####\n#### MLFA() function comes with the following rotation options:\n#### Uncorrelated Factors: Unrotated - Varimax - Quartimin - Bifactor  \n####   Correlated Factors:           - Promax              - BifactorOblique \n",
    "created" : 1425840804930.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "461560140",
    "id" : "78EADA53",
    "lastKnownWriteTime" : 1425840827,
    "path" : "~/GitHub/psy533/Homework/HW3 Adv EFA(Perkins).R",
    "project_path" : "Homework/HW3 Adv EFA(Perkins).R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}